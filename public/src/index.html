<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>WAM Open Studio 2.0</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.png">
	<link rel="stylesheet" href="style/style.css">
	<!--
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    -->
	<script src="libs/jquery-3.2.1.slim.min.js"  crossorigin="anonymous"></script>
	<script src="libs/popper.min.js"  crossorigin="anonymous"></script>

	<link rel="stylesheet" href="style/icons.css">

	<!--
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    -->
	<link rel="stylesheet" href="style/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<script src="libs/bootstrap.min.js"  crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
</head>

<body>
	<div class="loading-overlay">
		<div class="loading-wheel"></div>
		<div class="loading-text">Loading</div>
	</div>

	<div id="menu-bar">
		<div id="left-controls">
			<a class="menu-item main" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				<i class="menu-icon"></i>
			</a>
			<div class="dropdown-menu dropright" aria-labelledby="dropdownMenuButton">
				<div class="dropright">
					<a class="dropdown-item dropdown-toggle"  type="button" id="dropdownSubMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-i18n="menu.select_demo">Select Demo Project</a>
					<div id="songs-container" class="dropdown-menu songs" aria-labelledby="dropdownSubMenuButton"></div>
				</div>

				<div class="dropdown-divider"></div>

				<div class="dropright">
					<a class="dropdown-item dropdown-toggle" type="button" id="loadProjectSubMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-i18n="menu.load_project">Load project</a>
					<div class="dropdown-menu" aria-labelledby="loadProjectSubMenuButton">
						<a class="dropdown-item" id="load-project" data-i18n="menu.load_wam">WAM-Studio</a>
						<a class="dropdown-item" id="load-dawproject" data-i18n="menu.load_dawproject">dawproject</a>
					</div>
				</div>
				<div class="dropright">
					<a class="dropdown-item dropdown-toggle" type="button" id="saveProjectSubMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-i18n="menu.save_project">Save project</a>
					<div class="dropdown-menu" aria-labelledby="saveProjectSubMenuButton">
						<a class="dropdown-item" id="save-project" data-i18n="menu.save_wam">WAM-Studio</a>
						<a class="dropdown-item" id="save-dawproject" data-i18n="menu.save_dawproject">dawproject</a>
					</div>
				</div>
				
				<div class="dropright">
					<a class="dropdown-item dropdown-toggle" type="button" id="exportSubMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-i18n="menu.export_project">Render/Export project</a>
					<div class="dropdown-menu" aria-labelledby="exportSubMenuButton">
						<a class="dropdown-item" id="export-project" data-i18n="menu.export_audio">Audio</a>
						<a class="dropdown-item" id="export-midi" data-i18n="menu.export_midi">MIDI</a>
					</div>
				</div>

				<div class="dropdown-divider"></div>

				<div class="dropright">
					<a class="dropdown-item dropdown-toggle" type="button" id="importSubMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-i18n="menu.import">Import</a>
					<div class="dropdown-menu" aria-labelledby="importSubMenuButton">
						<a class="dropdown-item" id="import-songs" data-i18n="menu.import_audio">Audio file(s)</a>
						<a class="dropdown-item" id="import-midi-btn" data-i18n="menu.import_midi">MIDI file</a>
					</div>
				</div>
				<input id="new-track-input" type="file" accept=".mp3, .wav, .ogg" multiple style="display: none">
				<input id="new-midi-track-input" type="file" accept=".mid, .midi" multiple style="display: none">
				<input id="dawproject-input" type="file" accept=".dawproject" style="display: none">

				<div class="dropdown-divider advanced"></div>

				<a class="dropdown-item" id="keyboard-shortcuts-btn" data-i18n="menu.keyboard_shortcuts">Keyboard shortcuts</a>

				<div class="dropdown-divider advanced"></div>

				<a class="dropdown-item" id="latency-btn" data-i18n="menu.calibrate_latency">Calibrate latency compensation</a>
				<a class="dropdown-item" id="settings-btn" data-i18n="menu.settings">Settings</a>

				<div class="dropdown-divider advanced"></div>

				<a class="dropdown-item" id="login" data-i18n="menu.login">Log in</a>

				<div class="dropdown-divider advanced"></div>

				<a class="dropdown-item" id="playground-btn" data-i18n="menu.playground">Playground</a>

				<a class="dropdown-item" id="about-btn" data-i18n="menu.about">About</a>
			</div>

			<div id="back-btn" class="menu-item">
				<span class="mytooltip">Restart</span>
				<i class="skip-start-icon"></i>
			</div>
			<div id="play-btn" class="menu-item">
				<span class="mytooltip">Play</span>
				<i class="play-icon" id="play-icon"></i>
			</div>
			<div id="record-btn" class="menu-item">
				<span class="mytooltip">Record</span>
				<i class="record-icon"></i>
			</div>
			<div id="loop-btn" class="menu-item">
				<span class="mytooltip">Loop</span>
				<i class="loop-icon"></i>
			</div>
			<div class="timer-item noselect">
				<div id="timer" class="timer">
					00:00:00:000
				</div>
			</div>
			<div class="tempo-selector" id="tempo-selector">
				<!-- the tempo web component will be inserted here -->
			</div>
			<div class="time-signature-selector" id="time-signature-selector">
				<!-- the time-signature web component will be inserted here -->
			</div>
            <div id="tool-wrapper" style="position: relative; display: flex; align-items: center; height: 100%;">
                <div id="tool-btn" class="menu-item" style="height: 100%;">
                    <span class="mytooltip" data-i18n="tooltip.tool_mode">Tool Mode</span>
                    <i class="bi bi-cursor-fill" id="tool-icon" style="font-size: 30px; margin-bottom: 4px; color: #d3d3d3;"></i>
                </div>
                <div id="tool-menu" class="dropdown-menu" style="display: none; position: absolute; top: 100%; left: 0; z-index: 1000; min-width: 150px;">
                    <a class="dropdown-item" id="tool-select" data-i18n="tool.select"><i class="bi bi-cursor-fill"></i> Select Mode</a>
                    <a class="dropdown-item" id="tool-pen" data-i18n="tool.pen"><i class="bi bi-pencil-fill"></i> Pen Mode</a>
                </div>
            </div>
			<div id="metro-btn" class="menu-item">
				<span class="mytooltip" data-i18n="tooltip.metronome">Metronome</span>
				<i class="metro-icon" style="width: 36px"></i>
			</div>
			<button id="metro-btn-arrow" class="metro-btn-arrow" style="margin-left: -20px; z-index: 10;">▼</button>
			<div id="metronome"></div>
			<div id="mute-btn" class="menu-item">
				<span class="mytooltip" data-i18n="tooltip.mute">Mute</span>
				<i class="volume-up-icon" style="width: 36px" id="mute-icon"></i>
			</div>
            <div id="snap-wrapper" style="position: relative; display: flex; align-items: center; height: 100%;">
                <div id="snap-btn" class="menu-item" style="height: 100%;">
                    <span class="mytooltip" data-i18n="tooltip.snap_grid">Snap grid</span>
                    <i class="snap-icon" style="width: 30px" id="snap-icon"></i>
                </div>
                <button id="snap-btn-arrow" class="metro-btn-arrow" style="margin-left: -20px; z-index: 10;">▼</button>
                <div id="snap-menu" class="dropdown-menu" style="display: none; position: absolute; top: 100%; left: 0; z-index: 1000; min-width: 180px; background-color: #222; border: 1px solid #444;">
                    <a class="dropdown-item" id="snap-1-1" style="color: #eee; cursor: pointer;" data-i18n="snap.bar">1/1 (Bar)</a>
                    <a class="dropdown-item" id="snap-1-2" style="color: #eee; cursor: pointer;" data-i18n="snap.half">1/2 (Half)</a>
                    <a class="dropdown-item" id="snap-1-4" style="color: #eee; cursor: pointer;" data-i18n="snap.quarter">1/4 (Quarter) <span style="float:right">✓</span></a>
                    <a class="dropdown-item" id="snap-1-8" style="color: #eee; cursor: pointer;" data-i18n="snap.eighth">1/8 (Eighth)</a>
                    <a class="dropdown-item" id="snap-1-16" style="color: #eee; cursor: pointer;" data-i18n="snap.sixteenth">1/16 (Sixteenth)</a>
                    <a class="dropdown-item" id="snap-1-32" style="color: #eee; cursor: pointer;" data-i18n="snap.thirtysecond">1/32 (Thirty-second)</a>
                    <div class="dropdown-divider" style="border-top: 1px solid #444;"></div>
                    <a class="dropdown-item" id="snap-triplet" style="color: #eee; cursor: pointer;" data-i18n="snap.triplet">Triplet Mode <span id="snap-triplet-check" style="float: right; display: none;">✓</span></a>
                </div>
            </div>
			<div id="split-btn" class="menu-item">
				<span class="mytooltip" data-i18n="tooltip.split">Split region (S)</span>
				<i class="split-icon" style="width: 30px" id="split-icon"></i>
			</div>
			<div id="merge-btn" class="menu-item">
				<span class="mytooltip" data-i18n="tooltip.merge">Merge region (M)</span>
				<i class="merge-icon" style="width: 30px" id="merge-icon"></i>
			</div>

			<div id="undo-btn" class="menu-item">
				<span class="mytooltip" data-i18n="tooltip.undo">Undo</span>
				<i class="undo-icon-off" style="width: 30px" id="undo-icon"></i>
			</div>
			<div id="redo-btn" class="menu-item">
				<span class="mytooltip" data-i18n="tooltip.redo">Redo</span>
				<i class="redo-icon-off" style="width: 30px" id="redo-icon"></i>
			</div>
		</div>
		<div id="right-controls">
			<input id="spanZoomLevel" type="number" min="0.13" max="16" step="0.1" value="1.00" style="width: 80px; font-size: 1.2em; background: transparent; color: #d3d3d3; border: 1px solid #555; border-radius: 4px; text-align: center; margin-right: 10px;">
			<div id="zoom-out-btn" class="menu-item">
				<span class="mytooltip">Zoom out</span>
				<i class="zoom-out" style="width: 30px"></i>
			</div>
			<div id="zoom-in-btn" class="menu-item">
				<span class="mytooltip">Zoom in</span>
				<i class="zoom-in" style="width: 30px"></i>
			</div>
		</div>
	</div>

	<div id="app">
      <div id="left-container">
		<div id="track-editor">
			<div id="track-container">
				<div id="track-container-header">
					<div class="icon">
						<i class="music-file-icon"></i>
					</div>
					<div class="text-icon" data-i18n="header.tracks">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACKS
					</div>
				</div>



				<div id="new-track" class="new-track">
					<div class="new-track-text" data-i18n="header.new_track">
						New track
					</div>
					<div class="icon">
						<i class="plus-icon"></i>
					</div>

				</div>

				<div id="automation-menu" hidden>
				</div>
			</div>

			<div id="editor">
				<div id="editor-content">
					<div id="editor-canvas"></div>
					<scrollbar-element id="vertical-scrollbar" orientation="vertical"></scrollbar-element>
				</div>
				<scrollbar-element id="horizontal-scrollbar" orientation="horizontal"></scrollbar-element>

				<div id="automation-container"></div>
			</div>
		</div>
		<div id="plugin-editor">
			<div id="plugin-container-header">
				<div id="header-main-track">
					<div class="icon">
						<i class="sliders-icon"></i>
					</div>
					<div class="text-icon" data-i18n="header.master_track">
						MASTER TRACK
					</div>
				</div>

				<div class="icon">
					<i class="plugin-icon"></i>
				</div>
				<div class="text-icon" data-i18n="header.plugins">
					PLUGINS
				</div>

				<div id="min-max-btn">
					<i id="min-max-icon" class="arrow-down-icon"></i>
				</div>

			</div>

			<div id="plugins">
				<div id="main-track" style="color: #0c85d0">
					<!-- HERE PLACE THE HOST TRACK VIEW -->
				</div>
				<div id="add-plugins"></div>
				<div id="remove-plugins" class="new-track">
					<div class="new-track-text">
						Remove [WAM PLUGIN]
					</div>
					<div class="icon">
						<i class="close-icon" style="width: 40px"></i>
					</div>
				</div>
				<div id="hide-pedalboard" class="new-track">
					<div class="new-track-text">
						Hide [WAM PLUGIN]
					</div>
					<div class="icon">
						<i class="arrow-down-left-icon"></i>
					</div>
				</div>
				<div id="show-pedalboard" class="new-track">
					<div class="new-track-text">
						Show [WAM PLUGIN]
					</div>
					<div class="icon">
						<i class="arrow-up-right-icon"></i>
					</div>
				</div>
				<div id="loading-pedalboard" class="new-track">
					<div class="new-track-text">
						Loading [WAM PLUGIN]
					</div>
					<div class="icon">
						<i class="loading-icon"></i>
					</div>
				</div>
			</div>
		</div>
	  </div>
		<div id="audio-loop-browser"></div>
	  <div id="ToggleButtons">
		<button id="soundLoupBtn">
			<i class="bi bi-music-note-list"></i>
		</button>
	  </div>
	</div>

	<div id="plugin-window" class="floating-window" hidden>
		<div id="plugin-header" class="header-window">
			<span class="title">PedalBoard</span>
			<button id="plugin-close-button" class="close-button">X</button>
		</div>
		<div id="mount">

		</div>
	</div>

	<div id="latency-window" class="floating-window" hidden>
		<div id="latency-header" class="header-window">
			<span class="title" data-i18n="window.latency">Latency Compensation</span>
			<button id="latency-close-button" class="close-button">X</button>
		</div>
		<div class="settings-body">
			<div class="settings-item">
				<button id="calibration-button" type="button" data-i18n="window.calibrate">Calibrate Latency</button>
			</div>
			<div class="settings-tiny-item-text">
				Approach a Microphone near speakers, lower volume first, then press the button above.
				Increase slowly the volume until some latency values are displayed. Then stop.
				The latency compensation will be saved, no need to recalibrate on this device unless you change
				the hardware configuration.
			</div>
			<div class="settings-item">
				<input type="range" id="manual-latency" min="0" max="200" value="0">

				<label id="input-latency-label" for="manual-latency">Compensation 0 ms</label>
				<div id="roundtrip-latency-label" class="settings-item-text">
					Measured Roundtrip : N/A
				</div>
				<div id="output-latency-label" class="settings-item-text">
					Output Latency : N/A
				</div>
			</div>
			<div class="settings-item">
				<div class="settings-tiny-item-text">
					Latency refers to the duration that your device needs to process the sound picked up by your microphone and transmit it back to your speakers. The extent of this delay is determined by the type of device you are using and any additional hardware such as headphones or external microphones. While it is impossible to entirely eliminate latency, we can assist you in finding ways to deal with it.
				</div>
				<br>
				<div class="settings-tiny-item-text">
					Here’s a suggestion: Play a drum track while simultaneously recording some music or noise in rhythm. If you observe that the recorded track is out of sync with the drum track, it implies that you need to adjust for latency. You can accomplish this manually by adjusting the latency compensation slider or by using the automatic calibration button.
				</div>
			</div>
		</div>
	</div>

	<div id="settings-window" class="floating-window" hidden>
		<div id="settings-header" class="header-window">
			<span class="title" data-i18n="settings.title">Settings</span>
			<button id="settings-close-button" class="close-button">X</button>
		</div>
		<div class="settings-body">
			<div class="settings-item">
				<label for="select-input-device" data-i18n="settings.input_device">Input Device</label>
				<select class="select-input" id="select-input-device"></select>
			</div>
			<br>
			<div class="settings-item">
				<label for="select-output-device" data-i18n="settings.output_device">Output Device</label>
				<select class="select-input" id="select-output-device"></select>
			</div>
			<br>
			<div class="settings-item">
				<label for="select-midi-input-device" data-i18n="settings.midi_device">MIDI Device</label>
				<select class="select-input" id="select-midi-input-device"></select>
			</div>
			<br>
			<div class="settings-item">
				<label for="select-language" data-i18n="settings.language">Language</label>
				<select class="select-input" id="select-language">
					<option value="en">English</option>
					<option value="ja">日本語</option>
				</select>
			</div>
		</div>
	</div>

	<div id="keyboard-shortcuts-window" class="floating-window" hidden>
		<div id="keyboard-shortcuts-header" class="header-window">
			<span class="title">Keyboard shortcuts</span>
			<button id="keyboard-shortcuts-close-button" class="close-button">X</button>
		</div>
		<div class="settings-body" style="display:flex; justify-content: center; align-items: center">
			<div class="settings-small-item-text">
				<p><b>SPACE</b> - play on/off</p>
				<p><b>Control or Cmd + C/X/V</b> - copy/cut/paste selected region. 
					Paste can be done on another selected track.</p>
				<p><b>DEL or BACKSPACE on a selected region</b> -  deletes the region.</p>
				<p><b>S on a selected region</b> - split region in two separate regions.</p>
				<p><b>M on many selected regions</b> - merge the regions.</p>
				<p><b>Double click on the loop handle</b> - turn loop mode on/off.</p>
				<p><b>Shift while dragging region/playhead/loop handle</b> - bypass grid snapping if snapping is on.</p>
			</div>
		</div>
	</div>

	<div id="about-window" class="floating-window" hidden>
		<div id="about-header" class="header-window">
			<span class="title">About Wam Open Studio</span>
			<button id="about-close-button" class="close-button">X</button>
		</div>
		<div class="settings-body" style="display:flex; justify-content: center; align-items: center">
			<div>
				Contributors
			</div>
			<div class="settings-small-item-text">
				Wam Open Studio is a Work-In-Progress project by <a href="https://github.com/Brotherta" target="_blank">Antoine Vidal-Mazuy</a>,
				<a href="https://github.com/micbuffa" target="_blank">Michel Buffa</a> and <a href="https://github.com/Jempasam" target="_blank">Samuel Demont</a>.
				It is based on the <a href="https://github.com/webaudiomodules" target="_blank">Web Audio Modules standard</a> (WAM),
				which is an open source project that aims to make audio plugins available for the Web platform (aka VSTs for the Web).
				It has been developed as a showcase for the WAM standard, and to help developers understand how to use it.more
				You can find the DAW source code on <a href="https://github.com/Brotherta/wam-refont" target="_blank">Github</a>.
				If you want to contribute, please contact us by email (<a href="mailto:michel.buffa@univ-cotedazur.fr">michel.buffa@univ-cotedazur.fr</a>,
				<a href="mailto:antoine.vidalma@gmail.com">antoine.vidalma@gmail.com</a>) or
				in the #webaudio / webaudiomodules slack channel (get invitation here : <a href="https://web-audio-slackin.herokuapp.com/" target="_blank">https://web-audio-slackin.herokuapp.com/</a>).
			</div>

			<div>
				Special thanks
			</div>
			<div class="settings-small-item-text">
				Thanks to Paul Adenot from Mozilla for his help and tools: his Ring buffer, metronome and latency tester code has been adapted and included in this DAW.
				Original code can be found in
				<a href="https://github.com/padenot" target="_blank">Paul's GitHub repo</a>.
			</div>
			<div class="settings-small-item-text">
				Thanks also to <a href="https://github.com/QuentinBeauchet" target="_blank">Quentin Beauchet</a> for his help and his contributions
				with the Pedalboard / plugin manager (<a href="https://wam-bank.vidalmazuy.fr" target="_blank">wam-bank</a>).
			</div>

			<div>
				Web Audio Modules
			</div>
			<div class="settings-small-item-text">
				Web Audio Modules 2.0 contributors: Michel Buffa, Jerome Lebrun, Shihong Ren, Owen Campbell, Tom Burns, Steven Yi, Jari Kleimola, Oliver Larkin
			</div>
			<br>
			<div style="width: 100%; display: flex; justify-content: center">
				<img src="images/favicon.png" alt="Wam Open Studio" width="80" height="auto">
			</div>
		</div>
	</div>
	<div id="playground-window" class="floating-window" hidden>
		<div id="playground-header" class="header-window">
			<span class="title">Developper Playground</span>
			<button id="playground-close-button" class="close-button">X</button>
		</div>
	</div>

	<div id="project-window" class="floating-window" hidden>
		<div id="project-header" class="header-window">
			<span id="project-title" class="title">Advanced Window</span>
			<button id="project-close-button" class="close-button">X</button>
		</div>
		<div class="mount" id="project-mount">

		</div>
	</div>

	<div id="loading-zone"></div>

	<noscript>Please enable JavaScript in your web browser to view this page.</noscript>

</body>

</html>